var integrator=function(){if(window.integrator)return window.integrator;var e=[],t=[];const n=(e,t,n,r)=>{if(!r)return void console.log("unknown element");var o=r.functions[e];if(!o)return;const s=window.parent;o(n,(e=>{r?r.dispatchEvent(new CustomEvent(`response.${t}`,{detail:{id:t,response:{success:!0,error:null,result:e}}})):s.postMessage({id:t,response:{success:!0,error:null,result:e}},"*")}),(e=>{r?r.dispatchEvent(new CustomEvent(`response.${t}`,{detail:{id:t,response:{success:!1,error:e,result:null}}})):s.postMessage({id:t,response:{success:!0,error:null,result:result}},"*")}))};return{install:function(e){const t=e?"execute":"message",r=t=>{e?n(t.detail?.payload?.method,t.detail.id,t.detail?.payload?.args,e):n(t.data?.payload?.method,t.data.id,t.data?.payload?.args)},o=e??window;return o.addEventListener(t,r),()=>{o.removeEventListener(t,r)}},installHostMessageRelay:function(){window.addEventListener("message",(t=>{var n=e.filter((e=>e.contentWindow===t.source))?.at(0);if(n){if("watch"!==t.data.action)return;for(var[r,o]of Object.entries(t.data.reactiveVariables))n.dispatchEvent(new CustomEvent(`watch.${r}`,{detail:o}))}}))},register:function(e,t){null!=t&&"object"==typeof t&&!1===Array.isArray(t)&&(e.functions=e.functions??{},Object.assign(e.functions,t))},unregister:function(e,t){e?.functions[t]&&delete e?.functions[t]},update:function(e,t){if(t)for(var[n,r]of Object.entries(e))t.dispatchEvent(new CustomEvent(`watch.${n}`,{detail:r}));else window.parent&&window.parent.postMessage({action:"watch",reactiveVariables:e},"*")},addIframeById:function(e){var t=document.getElementById(e);this.addIframe(t)},removeIframeById:function(e){var t=document.getElementById(e);this.removeIframe(t)},addElement:function(n){const r=n?.tagName?.toLowerCase(),o="iframe"===r,s=void 0!==customElements.get(r);(o||s)&&((o?e:t).push(n),n.call=n.call??{},Object.keys(n.functions).map((e=>Object.assign(n.call,{[e]:function(...t){return new Promise(((r,s)=>{const a=Math.random().toString(36).substring(7),i=o?"message":`response.${a}`,d=o?window:n,c=e=>o?e.data:e.detail;function u(e){o&&e.source!==n.contentWindow||c(e).id===a&&(d.removeEventListener(i,u),r(c(e).response))}d.addEventListener(i,u),o?n.contentWindow.postMessage({id:a,payload:{method:e,args:t}},"*"):n.dispatchEvent(new CustomEvent("execute",{detail:{id:a,payload:{method:e,args:t}}})),setTimeout((()=>{d.removeEventListener(i,u),s(new Error("Timeout waiting for child response"))}),5e3)}))}}))))},removeElement:function(n){for(var r of(n?.call&&delete n.call,[e,t])){var o=r.indexOf(n);if(-1!==o)return void r.splice(o,1)}},getIframes:function(){return e},getWebComponents:function(){return t}}}();window.integrator=window.integrator??integrator;