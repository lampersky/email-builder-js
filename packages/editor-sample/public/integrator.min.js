var e=function(){if(window.integrator)return window.integrator;var e=[],t={};return window.addEventListener("message",(t=>{var n=e.filter((e=>e.contentWindow===t.source))?.at(0);if(n){if("watch"!==t.data.action)return;for(var[r,s]of Object.entries(t.data.reactiveVariables))n.dispatchEvent(new CustomEvent(`watch.${r}`,{detail:s}))}})),{install:function(){const e=e=>{((e,n,r)=>{var s=t[e];if(!s)return;const a=window.parent;s(r,(e=>{a.postMessage({id:n,response:{success:!0,error:null,result:e}},"*")}),(e=>{a.postMessage({id:n,response:{success:!1,error:e,result:null}},"*")}))})(e.data?.payload?.method,e.data.id,e.data?.payload?.args)};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},register:function(e,n){t[e]=n},unregister:function(e){t[e]&&delete t[e]},update:function(e){window.parent&&window.parent.postMessage({action:"watch",reactiveVariables:e},"*")},addIframeById:function(e){var t=document.getElementById(e);this.addIframe(t)},removeIframeById:function(e){var t=document.getElementById(e);this.removeIframe(t)},addIframe:function(t){e.push(t),Object.assign(t,{sendMessage(e){return new Promise(((t,n)=>{const r=this,s=Math.random().toString(36).substring(7);function a(e){e.source===r.contentWindow&&e.data.id===s&&(window.removeEventListener("message",a),t(e.data.response))}window.addEventListener("message",a),r.contentWindow.postMessage({id:s,payload:e},"*"),setTimeout((()=>{window.removeEventListener("message",a),n(new Error("Timeout waiting for child response"))}),5e3)}))}})},removeIframe:function(t){t?.sendMessage&&delete t.sendMessage;var n=e.indexOf(t);-1!==n&&e.splice(n,1)},getIframes:function(){return e},getFunctions:function(){return Object.keys(t)}}}();window.integrator=window.integrator??e;